<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>ARVIS - Matthew</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    * { user-select: none; }
    body { margin: 0; background: #000; color: #fff; overflow-x: hidden; }

    .notification-bar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: linear-gradient(90deg, #f59e0b, #d97706);
      color: #000;
      padding: 12px;
      text-align: center;
      font-weight: 600;
      z-index: 1000;
      transform: translateY(-100%);
      transition: transform 0.3s;
    }
    .notification-bar.show { transform: translateY(0); }
  </style>
</head>

<body class="bg-black">

<div id="notification-bar" class="notification-bar"></div>

<div class="min-h-screen p-4">

  <!-- Header -->
  <div class="flex justify-between items-center mb-6 pt-4">
    <div>
      <h1 class="text-3xl font-light">ARVIS</h1>
      <p class="text-gray-500 text-sm">Admin â€¢ Matthew</p>
    </div>
    <div class="flex gap-3">
      <button onclick="openNotifications()" class="relative p-3 rounded-full bg-gray-900 border border-gray-800">
        ðŸ””
        <span id="notif-badge" class="hidden absolute top-1 right-1 w-3 h-3 bg-yellow-500 rounded-full"></span>
      </button>
      <button onclick="logout()" class="p-3 rounded-full bg-gray-900 border border-gray-800">ðŸ”’</button>
    </div>
  </div>

  <!-- Time -->
  <div class="mb-4 p-5 rounded-2xl bg-gray-900 border border-gray-800">
    <div id="time" class="text-5xl font-light mb-2">--:--</div>
    <div id="date" class="text-xl text-gray-400 mb-3">Loading...</div>
    <div class="flex gap-4 text-sm text-gray-400">
      <span id="local-ip">IP: â€”</span>
      <span>WiFi: Connected</span>
    </div>
  </div>

  <!-- Quote -->
  <div class="mb-4 p-4 rounded-2xl bg-gray-900 border border-gray-800">
    <p id="quote" class="italic text-gray-300">Loadingâ€¦</p>
    <p id="author" class="text-sm text-gray-500"></p>
  </div>

  <!-- Weekend Countdown -->
  <div class="mb-4 p-4 rounded-2xl bg-gray-900 border border-gray-800">
    <div class="flex justify-between">
      <span>Weekend</span>
      <span id="weekend-time" class="text-green-400 font-mono">--</span>
    </div>
  </div>

</div>

<script>
/* ---------------- SAFE CORE ---------------- */

// Inactivity logout
let inactivityTimer;
function resetInactivityTimer() {
  clearTimeout(inactivityTimer);
  inactivityTimer = setTimeout(logout, 5 * 60 * 1000);
}
document.addEventListener('click', resetInactivityTimer);
document.addEventListener('touchstart', resetInactivityTimer);
resetInactivityTimer();

// Time
function updateTime() {
  const now = new Date();
  time.textContent = now.toLocaleTimeString([], {hour:'numeric', minute:'2-digit'});
  date.textContent = now.toLocaleDateString([], {weekday:'long', month:'long', day:'numeric'});
}
setInterval(updateTime, 1000);
updateTime();

// Local IP (fails silently on old browsers)
try {
  const pc = new RTCPeerConnection({iceServers:[]});
  pc.createDataChannel('');
  pc.createOffer().then(o => pc.setLocalDescription(o));
  pc.onicecandidate = e => {
    if (!e || !e.candidate) return;
    const ip = e.candidate.candidate.match(/(\d+\.\d+\.\d+\.\d+)/);
    if (ip) local-ip.textContent = `IP: ${ip[1]}`;
    pc.onicecandidate = null;
  };
} catch {}

// Quote (safe)
fetch('https://api.quotable.io/random')
  .then(r => r.json())
  .then(d => {
    quote.textContent = `"${d.content}"`;
    author.textContent = `â€” ${d.author}`;
  })
  .catch(() => {
    quote.textContent = `"Stay locked in."`;
    author.textContent = "â€” ARVIS";
  });

// Weekend countdown
function updateWeekendCountdown() {
  const now = new Date();
  let target = new Date(now);

  if (now.getDay() < 5) {
    target.setDate(now.getDate() + (5 - now.getDay()));
    target.setHours(15,45,0,0);
  } else {
    target.setDate(now.getDate() + ((8 - now.getDay()) % 7));
    target.setHours(0,0,0,0);
  }

  const diff = target - now;
  const h = Math.floor(diff / 36e5);
  const m = Math.floor((diff % 36e5) / 6e4);
  weekend-time.textContent = `${h}h ${m}m`;
}
setInterval(updateWeekendCountdown, 1000);
updateWeekendCountdown();

// Logout
function logout() {
  sessionStorage.clear();
  location.href = "index.html";
}

/* -------- ERROR HANDLING (NO RELOADS) -------- */
window.addEventListener('error', e => {
  console.warn("JS error caught:", e.message);
});
</script>

</body>
</html>
